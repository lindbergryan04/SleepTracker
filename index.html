<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleep Analysis</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%2210 0 100 100%22><text y=%22.90em%22 font-size=%2290%22>ðŸ›Œ</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="stars"></div>
    <main>
        <section class="intro">
            <h1 class="title">Unlock Your Best Sleep: The Hidden Science of Rest</h1>
            <p class="lead">Beyond just hours logged, true restorative sleep powers your daily energy, sharpens your
                mind, and balances your mood. Delve into the fascinating interplay of factors, including hormones and
                daily
                habits that dictate the quality of your slumber and learn how to truly recharge.</p>
        </section>

        <section class="modules">

            <section class="transition">
                <p>
                    Wearable devices can track key indicators necessary to measure sleep quality.<br> Let's explore our
                    dataset.
                </p>
            </section>

            <div class="module" id="efficiency">
                <h2>A Good Night's Sleep</h2>
                <p>
                    What defines a good night's sleep? It's deep, restorative rest shaped by
                    our daily exercise, hormone balance, and stress levels. We measure sleep quality using indicators
                    like <strong>Total Sleep Time (TST)</strong>, <strong>Wake After Sleep Onset (WASO)</strong>,
                    <strong>Sleep Fragmentation</strong>, and the <strong>Number of Awakenings</strong>. A key, simple
                    metric that captures overall sleep quality is <strong>Sleep Efficiency</strong>: the percentage of
                    time you're actually asleep in bed. <em>Let's start by examining how sleep efficiency varies among
                        the 22 individuals in our dataset. This will provide a foundation for exploring the deeper
                        factors that influence sleep quality.</em>
                </p>
                <div id="efficiency-chart">
                </div>
                <div id="chart-summary" class="chart-summary-text">
                    <p>For instance, <strong>User 12</strong> stands out with an impressive sleep efficiency of
                        <strong>94.23%</strong>, achieving 343 minutes of total sleep time with only 21 minutes of Wake
                        After Sleep Onset (WASO). In contrast, <strong>User 2</strong> shows a lower efficiency of
                        <strong>73.49%</strong>, with 244 minutes of total sleep time and a higher WASO of 84 minutes.
                        These examples highlight the significant individual differences in baseline sleep quality
                        present in our dataset. <em>Understanding this variability is the first step before we explore
                            specific influences like hormones and stress.</em>
                    </p>
                </div>
            </div>

            <section class="transition">
                <p>
                    Sleep quality varies. Why? Our body's hormones, like melatonin and cortisol, are crucial. When their
                    rhythms are off, sleep suffers
                    (<a href="https://www.nature.com/articles/s41598-019-54806-7" target="_blank"
                        rel="noopener noreferrer">Yamaguchi et al., 2019</a>).
                </p>
                <p style="font-size: 0.85rem; color: #c5c5c5; margin-top: 0.5em;">
                    <em>Referenced: Yamaguchi, M., et al. (2019). Light-induced melatonin suppression and sleepiness are
                        exaggerated under high sleep pressure. Scientific Reports, 9, 1â€“12.</em>
                </p>
            </section>


            <div class="module" id="hormones">
                <h2>Hormones</h2>
                <p>In the visualization below, we examine how melatonin and cortisol levels relate to different sleep
                    metrics. Each user has a blue bar for melatonin (top chart) and an orange bar for cortisol (bottom
                    chart). We've sorted the users horizontally so that 'better' sleep outcomes for the chosen metric
                    are generally on the right side, and 'poorer' outcomes are on the left. For the melatonin chart, an
                    upward-sloping trendline (when enabled) suggests a positive correlation: higher melatonin levels may
                    be linked to these better sleep outcomes. Hover over any bar to see the specific hormone value and
                    the selected sleep metric for that individual.</p>
                <div id="hormone-metric-context" class="metric-context-box">
                    <p><em>Metric context will appear here.</em></p>
                </div>
                <div class="chart-controls">
                    <div>
                        <label for="hormone-x-metric">Sort Users by:</label>
                        <select id="hormone-x-metric">
                            <option value="avg_efficiency">Sleep Efficiency</option>
                            <option value="totalSleepTime">Total Sleep Time (TST)</option>
                            <option value="wakeAfterSleepOnset">Wake After Sleep Onset (WASO)</option>
                            <option value="movementIndex">Movement Index</option>
                            <option value="sleepFragmentationIndex">Sleep Fragmentation Index</option>
                        </select>
                    </div>
                    <label for="hormone-trendline-checkbox">
                        Show Trendlines: <input type="checkbox" id="hormone-trendline-checkbox" checked>
                    </label>
                    <label for="hormone-context-toggle">
                        Show Metric Definition: <input type="checkbox" id="hormone-context-toggle" checked>
                    </label>
                </div>
                <div id="hormone-chart">
                </div>
                <div id="hormone-summary" class="chart-summary-text">
                    <p>
                        <!-- Filled with javascript -->
                    </p>
                </div>
            </div>

            <section class="transition">
                <p>
                    Beyond hormones, our mind matters. Stress impacts cortisol, and emotions can alter melatonin,
                    affecting sleep (<a
                        href="https://bmcpsychology.biomedcentral.com/articles/10.1186/s40359-024-01976-3"
                        target="_blank" rel="noopener noreferrer">Koyama et al., 2024</a>).
                </p>
                <p style="font-size: 0.85rem; color: #c5c5c5; margin-top: 0.5em;">
                    <em>Referenced: Koyama, A., et al. (2024). The association between perceived stress and sleep
                        quality in college students: a moderated mediation model. BMC Psychology, 12(1).</em>
                </p>
            </section>

            <div class="module" id="emotion">
                <h2>Stress and Emotion</h2>
                <p> In the following visualization,</p>
                <!-- I want to make it so that the user only has access to some of the dropdowns and rest later.
                  Or some are animated then teh dorp down show up later. also add add a lets see if positive emotions -> betetr sleep ?  -->
                <div class="stress-sleep-flex-container">
                    <div class="stress-sleep-left-column">
                        <h4>What is the relationship between Negative Emotions and Stress to Sleep Quality?</h4>
                        <p>
                            We see that higher daily stress scores generally mean more fragmented sleep. We see this
                            positive trend in the relationship to stress and all our sleep metrics.
                        </p>
                        <p>
                            The relationship of sleep with negative emotions is more difficult to explain. It's rather
                            clear the more sless leads to worst sleep. But instead with negative emotions we see that
                            have lower quality sleep is associated with more negative emotions. Though in our own data
                            this relationship seems weak due to our relativley small sample, this relationship is
                            supported. But all three are correlated with each other, high stress can lead to more
                            negative emotions, leading to worst sleep, and worst sleep and lead to more ngeative
                            emotions and threfore lead to high stress. Our goal is to highlight this relationship.
                        </p>
                        <p>
                            <strong>Consider:</strong> Individual responses to stress can vary widely due to lifestyle,
                            genetics,
                            and coping mechanisms. This chart provides a snapshot, not a definitive diagnosis.
                        </p>
                        <p style="font-size: 0.8em; color: #777; margin-top: 15px;">
                            <em>The Citation KARINA</em>
                        </p>
                    </div>
                    <div class="stress-sleep-right-column">
                        <div id="emotion-chart"></div>
                    </div>
                </div>
            </div>

            <section class="transition">
                <p>
                    Physical activity also shapes our sleep. Moderate exercise generally helps, but timing is key (<a
                        href="https://www.researchgate.net/publication/373188904_The_Effect_of_Physical_Activity_on_Sleep_Quality_and_Sleep_Disorder_A_Systematic_Review"
                        target="_blank" rel="noopener noreferrer">Alnawwar et al., 2023</a>).
                </p>
                <p style="font-size: 0.85rem; color: #c5c5c5; margin-top: 0.5em;">
                    <em>Referenced: Alnawwar, M. A., et al. (2023). The Effect of Physical Activity on Sleep Quality and
                        Sleep Disorder.</em>
                </p>
            </section>

            <div class="module" id="activity">
                <h2>Activity</h2>
                <p>More movement, better sleep. The actigraph recorded physical activity throughout the day to help us
                    understand how users' activity levels might influence their nightly rest. Physical activity is one
                    of the most consistent predictors of better sleep efficiency and duration across individuals.</p>
                <div id="activity-chart"></div>

                <!-- START: PCP Integration (replaces old #daily-activity-sleep-outcome) -->
                <div class="compact-scroll-module" id="pcp-scroll-trigger">
                    <section id="daily-activity-pcp-container" class="visualization-subsection"> <!-- Changed ID and class for context -->
                        <div class="visualization-text">
                            <p>This Parallel Coordinates Plot allows for an interactive exploration of relationships between daily activity metrics and sleep quality. Each colored line represents a user, connecting their values across the different axes. Use the filters to narrow down users by activity level, and try brushing on individual axes to highlight specific ranges and see how they correlate across metrics.</p> <!-- Updated Description -->
                        </div>
                        <div class="axis-selector" id="pcp-current-axis-selector"></div>
                        <div class="chart-controls" id="daily-activity-pcp-controls"> <!-- UPDATED ID -->
                            <!-- Controls for PCP (filter) will go here -->
                        </div>
                        <div id="daily-activity-pcp-visualization-area"> <!-- UPDATED ID -->
                            <!-- PCP will be rendered here -->
                        </div>
                    </section>
                </div>
                <!-- END: PCP Integration -->
                 
            </div>


            <section class="transition">
                <p>
                    Hormones, stress, and movement all play a significant role in shaping our sleep. Ready to see how
                    your habits measure up? Explore
                    our sleep predictor.
                </p>
            </section>

            <div class="module" id="summary">
                <h2>ðŸ”š Takeaway</h2>
                <p>Try setting your stress, activity, and hormone levels to see how your predicted sleep changes.</p>

                <!-- Sleep Predictor -->
                <h3>Predict Your Sleep</h3>
                <p>Adjust your estimated activity levels below (in minutes):</p>
                <div id="sliders"></div>
                <button id='predict' onclick="predict()">Predict Sleep</button>
                <div id="result" style="margin-top: 1rem;"></div>
            </div>
        </section>

        <div class="writeup">
            <h1>Project Writeup</h1>
            I have created a classification model that allows a user to input how many minutes of each activity they
            engaged in throughout the day, and returns their predicted sleep score given their most similar user. The
            code on the back end that does the classification is complete but I am still in the process of creating the
            sliders to allow the user to input their minutes per activity.
            I made a small multiples visualization that allows the user to select a detailed view version of the
            heatmap. It has 2 different hover Interactions that show the activity levels users in our dataset through
            step counts in hours or minutes, with a summary statistic corresponding to each view. I think the most
            challenging part will be to make sure that there is actually flow and story within our project, since we are
            working on visuals that are intuitive to use but may not be to the viewer.
            The most challenging part of our project to design is going to be the interactive portion, where we involve
            the user by predicting their sleep. We are going to have the user adjust their estimated levels of stress,
            activity, and hormones so this is definitely going to be challenging to execute.
        </div>
    </main>

    <div id="tooltip" class="tooltip" style="opacity:0;"></div>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="predict.js"></script>

    <script type="module" src="main.js"></script>
</body>

</html>