<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleep Analysis</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%2210 0 100 100%22><text y=%22.90em%22 font-size=%2290%22>üõå</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="stars"></div>
    <main>
        <section class="intro">
            <h1 class="title">Unlock Your Best Sleep: The Hidden Science of Rest</h1>
            <p class="lead">Beyond just hours logged, true restorative sleep powers your daily energy, sharpens your
                mind, and balances your mood. Delve into the fascinating interplay of factors, including hormones and
                daily
                habits that dictate the quality of your slumber and learn how to truly recharge.</p>
            <p class="group-names">Created by: Shriya Pattapu, Audrey Meredith, Ryan Lindberg, Karina Shah</p>
        </section>

        <section class="modules">

            <section class="transition">
                <p>
                    To understand sleep, we need data. Modern wearable devices, like those used to collect our <a
                        href="https://physionet.org/content/mmash/1.0.0/" target="_blank">dataset</a>, can track the key
                    indicators necessary to measure sleep quality. Let's explore the data from 22 individuals to uncover
                    the secrets of a good night's rest.
                </p>

            </section>

            <div class="module" id="metrics-explorer">
                <h2>üîç Decoding a Night's Rest: The Key Metrics</h2>
                <p>
                    To understand sleep, we must first learn its language. Our journey begins with the fundamental
                    metrics that define sleep quality. We'll explore what each one means and see how it varies across
                    our group of 22 individuals. Use the buttons below to step through each key indicator.
                </p>
                <div id="intro-metrics-container">
                    <h3 id="intro-metric-title"></h3>
                    <div id="intro-metric-vis"></div>
                    <p id="intro-metric-description"></p>
                    <div id="intro-metric-controls">
                        <button id="intro-prev-button" disabled>&larr; Previous</button>
                        <span id="intro-metric-counter"></span>
                        <button id="intro-next-button">Next &rarr;</button>
                    </div>
                </div>
            </div>

            <section class="transition">
                <p>
                    Now that we've seen that sleep quality can vary significantly between individuals, the next question
                    is: why? One of the biggest internal factors is our hormonal rhythm. Our body's primary "sleep" and
                    "wake" hormones, <strong>melatonin</strong> and <strong>cortisol</strong>, are crucial for
                    regulating our sleep cycle. When their natural rhythms are disrupted, our sleep can suffer (<a
                        href="https://www.nature.com/articles/s41598-019-54806-7" target="_blank"
                        rel="noopener noreferrer">Yamaguchi et al., 2019</a>).
                </p>
                <p style="font-size: 0.85rem; color: #c5c5c5; margin-top: 0.5em;">
                    <em>Referenced: Yamaguchi, M., et al. (2019). Light-induced melatonin suppression and sleepiness are
                        exaggerated under high sleep pressure. Scientific Reports, 9, 1‚Äì12.</em>
                </p>
            </section>


            <div class="module" id="hormones">
                <h2>üåô Hormones: The Conductors of Your Sleep Orchestra</h2>
                <p><strong>Melatonin</strong>, the 'sleep hormone', signals to your body that it's time for bed.
                    <strong>Cortisol</strong>, the 'stress hormone', follows an opposite rhythm, peaking in the morning
                    to promote wakefulness. A healthy sleep-wake cycle depends on these two hormones working in harmony.
                    Imbalances can lead to trouble falling asleep, frequent awakenings, and unrefreshing rest.
                </p>
                <p>In the visualization below, we examine how melatonin and cortisol levels relate to different sleep
                    metrics. Each point on the scatter plot represents a user, plotted based on the selected sleep
                    metric (X-axis) against their hormone levels (Y-axes). Melatonin is shown in blue (left Y-axis) and
                    cortisol in orange (right Y-axis). Hover over any point to see the specific values for that
                    individual.</p>
                <div id="hormone-metric-context" class="metric-context-box">
                    <p><em>Metric context will appear here.</em></p>
                </div>
                <div class="chart-controls">
                    <div>
                        <label for="hormone-x-metric">Sort Users by:</label>
                        <select id="hormone-x-metric">
                            <option value="avg_efficiency">Sleep Efficiency</option>
                            <option value="totalSleepTime">Total Sleep Time (TST)</option>
                            <option value="wakeAfterSleepOnset">Wake After Sleep Onset (WASO)</option>
                            <option value="movementIndex">Movement Index</option>
                            <option value="sleepFragmentationIndex">Sleep Fragmentation Index</option>
                        </select>
                    </div>
                    <label for="hormone-trendline-checkbox">
                        Show Trendlines: <input type="checkbox" id="hormone-trendline-checkbox" checked>
                    </label>
                    <label for="hormone-context-toggle">
                        Show Metric Definition: <input type="checkbox" id="hormone-context-toggle" checked>
                    </label>
                </div>
                <div id="hormone-chart">
                </div>
                <div id="hormone-summary" class="chart-summary-text">
                    <p>
                        <!-- Filled with javascript -->
                    </p>
                </div>
            </div>

            <section class="transition">
                <p>
                    But we are not just a collection of hormones. Our mental state plays a pivotal role in sleep.
                    Everyday stress can disrupt cortisol rhythms, while our emotions can influence melatonin production.
                    This creates a complex feedback loop between mind and body that directly impacts sleep quality (<a
                        href="https://bmcpsychology.biomedcentral.com/articles/10.1186/s40359-024-01976-3"
                        target="_blank" rel="noopener noreferrer">Koyama et al., 2024</a>).
                </p>
                <p style="font-size: 0.85rem; color: #c5c5c5; margin-top: 0.5em;">
                    <em>Referenced: Koyama, A., et al. (2024). The association between perceived stress and sleep
                        quality in college students: a moderated mediation model. BMC Psychology, 12(1).</em>
                </p>
            </section>

            <div class="module" id="emotion">
                <h2>üß† Stress and Emotion: The Mind-Sleep Connection</h2>
                <p>Our mental and emotional states are deeply intertwined with our sleep. High levels of stress can lead
                    to a state of hyperarousal, making it difficult to fall asleep and stay asleep. In the
                    visualization, we explore the connection between self-reported stress, emotions, and objective sleep
                    quality metrics. But it's not all bad news‚Äîcould positive emotions actually improve our sleep? Let's
                    investigate.</p>
                <div class="stress-sleep-flex-container">
                    <div class="stress-sleep-left-column">
                        <h4>The Vicious Cycle of Stress, Negative Emotions, and Poor Sleep</h4>
                        <p>
                            It's a well-known cycle: stress hurts sleep, and poor sleep makes us more vulnerable to
                            stress. Our data suggests a similar pattern. Higher daily stress scores tend to correlate
                            with more fragmented and lower-quality sleep.
                        </p>
                        <p>
                            The link with negative emotions is more complex. While our dataset shows a weak connection,
                            likely due to its small size, broader research confirms that poor sleep can amplify negative
                            feelings, which in turn can make it harder to sleep. Stress, negative emotions, and poor
                            sleep are often entangled in a feedback loop. Our goal here is to visualize and untangle
                            these relationships.
                        </p>
                        <p>
                            <strong>Consider:</strong> Individual responses to stress can vary widely due to lifestyle,
                            genetics,
                            and coping mechanisms. This chart provides a snapshot, not a definitive diagnosis.
                        </p>
                    </div>
                    <div class="stress-sleep-right-column">
                        <div id="emotion-chart"></div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <a href="stress_quiz.html" class="button-style">See how you compare</a>
                </div>
            </div>

            <section class="transition">
                <p>
                    Finally, let's turn to a factor where we have significant control: our physical activity. How we
                    move our bodies during the day can profoundly impact how we rest at night. While moderate exercise
                    is generally beneficial, research shows that timing and intensity are key to unlocking its
                    sleep-promoting benefits (<a
                        href="https://www.researchgate.net/publication/373188904_The_Effect_of_Physical_Activity_on_Sleep_Quality_and_Sleep_Disorder_A_Systematic_Review"
                        target="_blank" rel="noopener noreferrer">Alnawwar et al., 2023</a>).
                </p>
                <p style="font-size: 0.85rem; color: #c5c5c5; margin-top: 0.5em;">
                    <em>Referenced: Alnawwar, M. A., et al. (2023). The Effect of Physical Activity on Sleep Quality and
                        Sleep Disorder.</em>
                </p>
            </section>

            <div class="module" id="activity">
                <h2>üèÉ‚Äç‚ôÄÔ∏è Activity</h2>
                <p>More movement, better sleep. The actigraph recorded physical activity throughout the day to help us
                    understand how users' activity levels might influence their nightly rest. Physical activity is one
                    of the most consistent predictors of better sleep efficiency and duration across individuals.</p>
                <div id="activity-chart"></div>

                <!-- START: PCP Integration (replaces old #daily-activity-sleep-outcome) -->
                <div class="compact-scroll-module" id="pcp-scroll-trigger">
                    <section id="daily-activity-pcp-container" class="visualization-subsection">
                        <!-- Changed ID and class for context -->
                        <div class="visualization-text">
                            <p>This Parallel Coordinates Plot allows for an interactive exploration of relationships
                                between daily activity metrics and sleep quality. Each colored line represents a user,
                                connecting their values across the different axes. Use the filters to narrow down users
                                by activity level, and try brushing on individual axes to highlight specific ranges and
                                see how they correlate across metrics.</p> <!-- Updated Description -->
                        </div>
                        <div class="axis-selector" id="pcp-current-axis-selector"></div>
                        <div class="chart-controls" id="daily-activity-pcp-controls"> <!-- UPDATED ID -->
                            <!-- Controls for PCP (filter) will go here -->
                        </div>
                        <div id="daily-activity-pcp-visualization-area"> <!-- UPDATED ID -->
                            <!-- PCP will be rendered here -->
                        </div>
                    </section>
                </div>
                <!-- END: PCP Integration -->

            </div>


            <section class="transition">
                <p>
                    As we have seen, hormones, stress, and movement all play a significant role in shaping our sleep.
                    Ready to see how
                    your habits measure up? Explore
                    our sleep predictor.
                </p>
            </section>

            <div class="module" id="summary">
                <h2>üß© Putting It All Together: From Data to Discovery</h2>
                <p>We've journeyed through the core pillars of sleep quality: hormonal balance, emotional well-being,
                    and physical activity. We've seen how they vary and interact within our dataset. Now, it's your turn
                    to apply these insights.</p>

                <!-- Sleep Predictor -->
                <h3>Predict Your Sleep</h3>
                <p>Adjust the sliders below to represent your typical daily habits and states. Our model, based on the
                    data from our 22 participants, will predict your potential sleep efficiency.</p>
                <div id="sliders"></div>
                <button id='predict' onclick="predict()">Predict Sleep</button>
                <div id="result" style="margin-top: 1rem;"></div>
            </div>
        </section>
        <div class="module" id="Conclusion">
            <h2>Conclusion üò¥</h2>
            <p>
                Improving sleep is a journey, not a quick fix. Even small changes‚Äîlike winding down before bed, getting regular exercise, or practicing mindfulness‚Äîcan lead to meaningful results over time. What works for one person may not work for another, so track your habits, try new routines, and notice how your body responds. With consistency and reflection, you'll find what helps you wake up truly refreshed.
            </p>
        </div>
    </main>

    <footer>
        <div class="footer-links">
            <a href="#references">References</a>
            <a href="#demo">Demo Video</a>
            <a href="#source-code">Source Code</a>
        </div>
        <p>&copy; 2024 SleepTracker. All Rights Reserved.</p>
    </footer>

    <div id="tooltip" class="tooltip" style="opacity:0;"></div>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="predict.js"></script>

    <script type="module" src="main.js"></script>
</body>

</html>